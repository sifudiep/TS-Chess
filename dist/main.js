(()=>{"use strict";var i={43:(i,o)=>{o.c=void 0;o.c=function(i,o){this.X=i,this.Y=o}},200:(i,o)=>{o.X=void 0;o.X=function(i,o,e){this.HasBeenMoved=!1,this.JustMadeFirstMove=!1,this.LegalMoves=[],this.Moves=[],this.IsWhite=i,this.CurrentPosition=o,this.Name=e}}},o={};function e(n){var t=o[n];if(void 0!==t)return t.exports;var r=o[n]={exports:{}};return i[n](r,r.exports,e),r.exports}(()=>{var i,o,n,t=e(200),r=e(43),s=new Audio("./sfx/move.wav"),u=new Audio("./sfx/check.wav"),v=new Audio("./sfx/error.wav"),l=!0,a=[[],[],[],[],[],[],[],[]],d=!1,C=!1;function P(i){var o,e,n,t,s,u,v,l,d,C,P,h,c,X,Y,w;if(0==i.CurrentPosition.Y||7==i.CurrentPosition.Y){var f=i.CurrentPosition,M=i.IsWhite;H(i.CurrentPosition),p(M,f),b(a[f.X][f.Y])}i.IsWhite?(i.CurrentPosition.X-1>=0&&void 0!==a[i.CurrentPosition.X-1][i.CurrentPosition.Y+1]&&!1===(null===(o=a[i.CurrentPosition.X-1][i.CurrentPosition.Y+1])||void 0===o?void 0:o.IsWhite)&&i.LegalMoves.push(new r.c(i.CurrentPosition.X-1,i.CurrentPosition.Y+1)),i.CurrentPosition.X+1<=7&&void 0!==a[i.CurrentPosition.X+1][i.CurrentPosition.Y+1]&&!1===(null===(e=a[i.CurrentPosition.X+1][i.CurrentPosition.Y+1])||void 0===e?void 0:e.IsWhite)&&i.LegalMoves.push(new r.c(i.CurrentPosition.X+1,i.CurrentPosition.Y+1)),void 0===a[i.CurrentPosition.X][i.CurrentPosition.Y+1]&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X,i.CurrentPosition.Y+1)),void 0===a[i.CurrentPosition.X][i.CurrentPosition.Y+2]&&!1===i.HasBeenMoved&&i.LegalMoves.push(new r.c(i.CurrentPosition.X,i.CurrentPosition.Y+2))),i.CurrentPosition.X+1<=7&&void 0!==a[i.CurrentPosition.X+1][i.CurrentPosition.Y]&&"Pawn"===(null===(n=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===n?void 0:n.Name)&&(null===(t=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===t?void 0:t.JustMadeFirstMove)&&(null===(s=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===s?void 0:s.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(i.CurrentPosition.X+1,i.CurrentPosition.Y+1)),i.CurrentPosition.X-1>=0&&void 0!==a[i.CurrentPosition.X-1][i.CurrentPosition.Y]&&"Pawn"===(null===(u=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===u?void 0:u.Name)&&(null===(v=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===v?void 0:v.JustMadeFirstMove)&&(null===(l=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===l?void 0:l.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(i.CurrentPosition.X-1,i.CurrentPosition.Y+1))):(i.CurrentPosition.X-1>=0&&void 0!==a[i.CurrentPosition.X-1][i.CurrentPosition.Y-1]&&!0===(null===(d=a[i.CurrentPosition.X-1][i.CurrentPosition.Y-1])||void 0===d?void 0:d.IsWhite)&&i.LegalMoves.push(new r.c(i.CurrentPosition.X-1,i.CurrentPosition.Y-1)),i.CurrentPosition.X+1<=7&&void 0!==a[i.CurrentPosition.X+1][i.CurrentPosition.Y-1]&&!0===(null===(C=a[i.CurrentPosition.X+1][i.CurrentPosition.Y-1])||void 0===C?void 0:C.IsWhite)&&i.LegalMoves.push(new r.c(i.CurrentPosition.X+1,i.CurrentPosition.Y-1)),void 0===a[i.CurrentPosition.X][i.CurrentPosition.Y-1]&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X,i.CurrentPosition.Y-1)),void 0===a[i.CurrentPosition.X][i.CurrentPosition.Y-2]&&!1===i.HasBeenMoved&&i.LegalMoves.push(new r.c(i.CurrentPosition.X,i.CurrentPosition.Y-2))),i.CurrentPosition.X+1<=7&&void 0!==a[i.CurrentPosition.X+1][i.CurrentPosition.Y]&&"Pawn"===(null===(P=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===P?void 0:P.Name)&&(null===(h=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===h?void 0:h.JustMadeFirstMove)&&(null===(c=a[i.CurrentPosition.X+1][i.CurrentPosition.Y])||void 0===c?void 0:c.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(i.CurrentPosition.X+1,i.CurrentPosition.Y-1)),i.CurrentPosition.X-1>=0&&void 0!==a[i.CurrentPosition.X-1][i.CurrentPosition.Y]&&"Pawn"===(null===(X=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===X?void 0:X.Name)&&(null===(Y=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===Y?void 0:Y.JustMadeFirstMove)&&(null===(w=a[i.CurrentPosition.X-1][i.CurrentPosition.Y])||void 0===w?void 0:w.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(i.CurrentPosition.X-1,i.CurrentPosition.Y-1)))}function h(i){for(var o,e,n,t,s=i.CurrentPosition.X-1;s>=0&&(null===(o=a[s][i.CurrentPosition.Y])||void 0===o?void 0:o.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(s,i.CurrentPosition.Y)),void 0===a[s][i.CurrentPosition.Y]);s--);for(s=i.CurrentPosition.X+1;s<=7&&(null===(e=a[s][i.CurrentPosition.Y])||void 0===e?void 0:e.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(s,i.CurrentPosition.Y)),void 0===a[s][i.CurrentPosition.Y]);s++);for(s=i.CurrentPosition.Y-1;s>=0&&(null===(n=a[i.CurrentPosition.X][s])||void 0===n?void 0:n.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X,s)),void 0===a[i.CurrentPosition.X][s]);s--);for(s=i.CurrentPosition.Y+1;s<=7&&(null===(t=a[i.CurrentPosition.X][s])||void 0===t?void 0:t.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X,s)),void 0===a[i.CurrentPosition.X][s]);s++);}function c(i){for(var o,e,n,t,s=1;i.CurrentPosition.X+s<=7&&i.CurrentPosition.Y+s<=7&&(null===(o=a[i.CurrentPosition.X+s][i.CurrentPosition.Y+s])||void 0===o?void 0:o.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X+s,i.CurrentPosition.Y+s)),void 0===a[i.CurrentPosition.X+s][i.CurrentPosition.Y+s]);s++);for(s=1;i.CurrentPosition.X-s>=0&&i.CurrentPosition.Y+s<=7&&(null===(e=a[i.CurrentPosition.X-s][i.CurrentPosition.Y+s])||void 0===e?void 0:e.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X-s,i.CurrentPosition.Y+s)),void 0===a[i.CurrentPosition.X-s][i.CurrentPosition.Y+s]);s++);for(s=1;i.CurrentPosition.X+s<=7&&i.CurrentPosition.Y-s>=0&&(null===(n=a[i.CurrentPosition.X+s][i.CurrentPosition.Y-s])||void 0===n?void 0:n.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X+s,i.CurrentPosition.Y-s)),void 0===a[i.CurrentPosition.X+s][i.CurrentPosition.Y-s]);s++);for(s=1;i.CurrentPosition.X-s>=0&&i.CurrentPosition.Y-s>=0&&(null===(t=a[i.CurrentPosition.X-s][i.CurrentPosition.Y-s])||void 0===t?void 0:t.IsWhite)!==i.IsWhite&&(i.LegalMoves.push(new r.c(i.CurrentPosition.X-s,i.CurrentPosition.Y-s)),void 0===a[i.CurrentPosition.X-s][i.CurrentPosition.Y-s]);s++);}function X(i){var o,e,n,t,s,u,v,l,d=i.CurrentPosition.Y,C=i.CurrentPosition.X;d+2<=7&&(C+1<=7&&(null===(o=a[C+1][d+2])||void 0===o?void 0:o.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C+1,d+2)),C-1>=0&&(null===(e=a[C-1][d+2])||void 0===e?void 0:e.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C-1,d+2))),d-2>=0&&(C+1<=7&&(null===(n=a[C+1][d-2])||void 0===n?void 0:n.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C+1,d-2)),C-1>=0&&(null===(t=a[C-1][d-2])||void 0===t?void 0:t.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C-1,d-2))),C+2<=7&&(d+1<=7&&(null===(s=a[C+2][d+1])||void 0===s?void 0:s.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C+2,d+1)),d-1>=0&&(null===(u=a[C+2][d-1])||void 0===u?void 0:u.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C+2,d-1))),C-2>=0&&(d+1<=7&&(null===(v=a[C-2][d+1])||void 0===v?void 0:v.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C-2,d+1)),d-1>=0&&(null===(l=a[C-2][d-1])||void 0===l?void 0:l.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(C-2,d-1)))}function Y(i){var o,e,n,t,s,u,v,l,P,h,c=i.CurrentPosition.X,X=i.CurrentPosition.Y;c+1<=7&&(null===(o=a[c+1][X])||void 0===o?void 0:o.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c+1,X)),c+1<=7&&X+1<=7&&(null===(e=a[c+1][X+1])||void 0===e?void 0:e.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c+1,X+1)),c+1<=7&&X-1>=0&&(null===(n=a[c+1][X-1])||void 0===n?void 0:n.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c+1,X-1)),c-1>=0&&(null===(t=a[c-1][X])||void 0===t?void 0:t.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c-1,X)),c-1>=0&&X+1<=7&&(null===(s=a[c-1][X+1])||void 0===s?void 0:s.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c-1,X+1)),c-1>=0&&X-1>=0&&(null===(u=a[c-1][X-1])||void 0===u?void 0:u.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c-1,X-1)),X+1<=7&&(null===(v=a[c][X+1])||void 0===v?void 0:v.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c,X+1)),X-1>=0&&(null===(l=a[c][X-1])||void 0===l?void 0:l.IsWhite)!==i.IsWhite&&i.LegalMoves.push(new r.c(c,X-1));var Y=i.IsWhite?d:C;i.HasBeenMoved||Y||(void 0===a[5][i.CurrentPosition.Y]&&void 0===a[6][i.CurrentPosition.Y]&&void 0!==a[7][i.CurrentPosition.Y]&&!1===(null===(P=a[7][i.CurrentPosition.Y])||void 0===P?void 0:P.HasBeenMoved)&&(i.LegalMoves.push(new r.c(6,i.CurrentPosition.Y)),i.LegalMoves.push(new r.c(7,i.CurrentPosition.Y))),void 0===a[3][i.CurrentPosition.Y]&&void 0===a[2][i.CurrentPosition.Y]&&void 0!==a[0][i.CurrentPosition.Y]&&!1===(null===(h=a[0][i.CurrentPosition.Y])||void 0===h?void 0:h.HasBeenMoved)&&(i.LegalMoves.push(new r.c(2,i.CurrentPosition.Y)),i.LegalMoves.push(new r.c(0,i.CurrentPosition.Y))))}function w(i,o){var e=new t.X(i,o,"Pawn");e.Moves.push(P),a[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function f(i,o){var e=new t.X(i,o,"Rook");e.Moves.push(h),a[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function M(i,o){var e=new t.X(i,o,"Bishop");e.Moves.push(c),a[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function g(i,o){var e=new t.X(i,o,"Knight");e.Moves.push(X),a[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function I(i,e){var r=new t.X(i,e,"King");r.Moves.push(Y),a[r.CurrentPosition.X][r.CurrentPosition.Y]=r,i?o=r:n=r}function p(i,o){var e=new t.X(i,o,"Queen");e.Moves.push(c),e.Moves.push(h),a[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function W(){for(var i=0;i<8;i++)for(var o=0;o<8;o++){var e=a[o][i];if(void 0!==e){var n=document.getElementById("row-"+(i+1));if(null==n)throw Error;0===n.children[o].children.length&&b(e)}}}function L(i){var o=document.getElementById("row-"+(i.Y+1));if(null!=o)return o.children[i.X];throw Error}function m(i){var o=L(i);null!=o.firstElementChild&&o.removeChild(o.firstElementChild)}function E(i,o){a[i.CurrentPosition.X][i.CurrentPosition.Y]=void 0,i.CurrentPosition=o,a[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function b(i){var o,e=L(i.CurrentPosition),n=(o=i.CurrentPosition,a[o.X][o.Y]);if(null==n)throw Error;for(;null!=e.firstElementChild;)e.removeChild(e.firstElementChild);var t=document.createElement("div");t.setAttribute("style",'background-image: url("./pieces/'+(n.IsWhite?"light":"dark")+"-"+n.Name.toLowerCase()+'.svg")'),t.setAttribute("class"," piece-background"),t.setAttribute("draggable","true"),e.appendChild(t)}function N(i){var o=-1,e=parseInt(i[1])-1;if(2===i.length)switch(i[0]){case"a":o=0;break;case"b":o=1;break;case"c":o=2;break;case"d":o=3;break;case"e":o=4;break;case"f":o=5;break;case"g":o=6;break;case"h":o=7}return new r.c(o,e)}function k(i,o){var e,n;if("King"===i.Name){var t=i.CurrentPosition.X-o.X;if(Math.abs(t)>1)if(t>0){for(var v=3;v>=2;v--)if(B(i,new r.c(v,i.CurrentPosition.Y)))return;o.X=2,k(a[0][i.CurrentPosition.Y],new r.c(3,i.CurrentPosition.Y))}else{for(v=5;v<=6;v++)if(B(i,new r.c(v,i.CurrentPosition.Y)))return;o.X=6,k(a[7][i.CurrentPosition.Y],new r.c(5,i.CurrentPosition.Y))}}if("Pawn"===i.Name&&(!1===i.HasBeenMoved&&(i.JustMadeFirstMove=!0),void 0===a[o.X][o.Y])){var l=i.IsWhite?o.Y-1:o.Y+1;void 0!==a[o.X][l]&&"Pawn"===(null===(e=a[o.X][l])||void 0===e?void 0:e.Name)&&(null===(n=a[o.X][l])||void 0===n?void 0:n.IsWhite)!==i.IsWhite&&H(new r.c(o.X,l))}var P=i.CurrentPosition;m(P),H(o),E(i,o),b(i),a[P.X][P.Y]=void 0,F(),C||d?u.play():s.play()}function B(i,o){var e=i.CurrentPosition,n=a[o.X][o.Y];A(i),E(i,o),F();var t=!1;return i.IsWhite&&d&&(t=!0),!1===i.IsWhite&&C&&(t=!0),E(i,e),y(i),void 0!==n&&E(n,n.CurrentPosition),t&&v.play(),t}function y(i){i.LegalMoves=[];for(var o=0;o<i.Moves.length;o++)i.Moves[o](i)}function A(i){for(var o=0;o<i.LegalMoves.length;o++){var e=L(i.LegalMoves[o]);e.className=e.className.replace(" legalMove","")}}function F(){d=!1,C=!1;for(var i=function(i){for(var e=function(e){if(void 0===a[e][i])return"continue";y(a[e][i]);var t=a[e][i].IsWhite?n:o;a[e][i].LegalMoves.forEach((function(o){var n;o.X===t.CurrentPosition.X&&o.Y===t.CurrentPosition.Y&&((null===(n=a[e][i])||void 0===n?void 0:n.IsWhite)?C=!0:d=!0)}))},t=0;t<=7;t++)e(t)},e=0;e<=7;e++)i(e)}function H(i){void 0!==a[i.X][i.Y]&&(m(i),a[i.X][i.Y]=void 0)}!function(){var i=document.getElementById("chessBoard");if(null==i)throw Error;for(var o=!0,e=0;e<i.children.length;e++){for(var n=i.children[e],t=0;t<n.children.length;t++)n.children[t].className+=o?" light-cell":" dark-cell",o=!o;o=!o}}(),function(){for(var i=0;i<8;i++)w(!0,new r.c(i,1));for(f(!0,new r.c(0,0)),f(!0,new r.c(7,0)),g(!0,new r.c(1,0)),g(!0,new r.c(6,0)),M(!0,new r.c(2,0)),M(!0,new r.c(5,0)),I(!0,new r.c(4,0)),p(!0,new r.c(3,0)),i=0;i<8;i++)w(!1,new r.c(i,6));f(!1,new r.c(0,7)),f(!1,new r.c(7,7)),g(!1,new r.c(1,7)),g(!1,new r.c(6,7)),M(!1,new r.c(2,7)),M(!1,new r.c(5,7)),I(!1,new r.c(4,7)),p(!1,new r.c(3,7))}(),W(),document.addEventListener("dragstart",(function(o){var e=parseInt(o.path[1].id.replace("col-",""))-1,n=parseInt(o.path[1].getAttribute("row"))-1,t=a[e][n];null!=t&&t.IsWhite===l&&(y(t),function(i){for(var o=0;o<i.LegalMoves.length;o++)L(i.LegalMoves[o]).className+=" legalMove"}(t),i=t)})),document.addEventListener("dragend",(function(o){var e=parseInt(o.path[1].id.replace("col-",""))-1,n=parseInt(o.path[1].getAttribute("row"))-1;null!=a[e][n]&&A(i)})),document.addEventListener("dragover",(function(i){i.preventDefault()})),document.addEventListener("drop",(function(o){if(o.preventDefault(),!o)return!1;if(o.target.className.includes("legalMove")||o.target.parentElement.className.includes("legalMove")){var e=function(i){var o;if("DIV"===i.nodeName)o=i;else{if("IMG"!==i.nodeName)throw Error;o=i.parentElement}var e=parseInt(o.getAttribute("row"))-1,n=parseInt(o.id.replace("col-",""))-1;return new r.c(n,e)}(o.target.className.includes("legalMove")?o.target:o.target.parentElement);!1===B(i,e)&&(function(){for(var i=0;i<=7;i++)for(var o=0;o<=7;o++){var e=a[o][i];void 0!==e&&"Pawn"===e.Name&&e.JustMadeFirstMove&&(e.JustMadeFirstMove=!1)}}(),k(i,e),l=!l,i.HasBeenMoved=!0,W()),A(i)}})),F(),document.addEventListener("keypress",(function(i){if("Enter"===i.key){var o=document.querySelector("input");if(null!==o){var e=null==o?void 0:o.value;void 0!==e&&(t=N((n=e).substring(0,2)),r=N(n.substring(2,4)),void 0!==(s=a[t.X][t.Y])&&k(s,r))}o.value=""}var n,t,r,s}))})()})();