(()=>{"use strict";var o={506:(o,e)=>{e.__esModule=!0,e.Coordinate=void 0;e.Coordinate=function(o,e){this.X=o,this.Y=e}},142:(o,e)=>{e.__esModule=!0,e.Piece=void 0;e.Piece=function(o,e,i){this.HasBeenMoved=!1,this.LegalMoves=[],this.Moves=[],this.IsWhite=o,this.CurrentPosition=e,this.Name=i}}},e={};function i(n){var t=e[n];if(void 0!==t)return t.exports;var r=e[n]={exports:{}};return o[n](r,r.exports,i),r.exports}(()=>{var o,e,n,t=i(142),r=i(506),s=!0,u=[[],[],[],[],[],[],[],[]],a=!1,v=!1;function d(o){var e,i,n,t;if(0==o.CurrentPosition.Y||7==o.CurrentPosition.Y){var s=o.CurrentPosition,a=o.IsWhite;b(o.CurrentPosition),w(a,s),L(u[s.X][s.Y])}o.IsWhite?(o.CurrentPosition.X-1>=0&&void 0!==u[o.CurrentPosition.X-1][o.CurrentPosition.Y+1]&&!1===(null===(e=u[o.CurrentPosition.X-1][o.CurrentPosition.Y+1])||void 0===e?void 0:e.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y+1)),o.CurrentPosition.X+1<=7&&void 0!==u[o.CurrentPosition.X+1][o.CurrentPosition.Y+1]&&!1===(null===(i=u[o.CurrentPosition.X+1][o.CurrentPosition.Y+1])||void 0===i?void 0:i.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y+1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y+1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y+2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+2)))):(o.CurrentPosition.X-1>=0&&void 0!==u[o.CurrentPosition.X-1][o.CurrentPosition.Y-1]&&!0===(null===(n=u[o.CurrentPosition.X-1][o.CurrentPosition.Y-1])||void 0===n?void 0:n.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y-1)),o.CurrentPosition.X+1<=7&&void 0!==u[o.CurrentPosition.X+1][o.CurrentPosition.Y-1]&&!0===(null===(t=u[o.CurrentPosition.X+1][o.CurrentPosition.Y-1])||void 0===t?void 0:t.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y-1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y-1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y-2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-2))))}function l(o){for(var e,i,n,t,s=o.CurrentPosition.X-1;s>=0&&(null===(e=u[s][o.CurrentPosition.Y])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===u[s][o.CurrentPosition.Y]);s--);for(s=o.CurrentPosition.X+1;s<=7&&(null===(i=u[s][o.CurrentPosition.Y])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===u[s][o.CurrentPosition.Y]);s++);for(s=o.CurrentPosition.Y-1;s>=0&&(null===(n=u[o.CurrentPosition.X][s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===u[o.CurrentPosition.X][s]);s--);for(s=o.CurrentPosition.Y+1;s<=7&&(null===(t=u[o.CurrentPosition.X][s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===u[o.CurrentPosition.X][s]);s++);}function C(o){for(var e,i,n,t,s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y+s<=7&&(null===(e=u[o.CurrentPosition.X+s][o.CurrentPosition.Y+s])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y+s)),void 0===u[o.CurrentPosition.X+s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y+s<=7&&(null===(i=u[o.CurrentPosition.X-s][o.CurrentPosition.Y+s])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y+s)),void 0===u[o.CurrentPosition.X-s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y-s>=0&&(null===(n=u[o.CurrentPosition.X+s][o.CurrentPosition.Y-s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y-s)),void 0===u[o.CurrentPosition.X+s][o.CurrentPosition.Y-s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y-s>=0&&(null===(t=u[o.CurrentPosition.X-s][o.CurrentPosition.Y-s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y-s)),void 0===u[o.CurrentPosition.X-s][o.CurrentPosition.Y-s]);s++);}function h(o){var e,i,n,t,s,a,v,d,l=o.CurrentPosition.Y,C=o.CurrentPosition.X;l+2<=7&&(C+1<=7&&(null===(e=u[C+1][l+2])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C+1,l+2)),C-1>=0&&(null===(i=u[C-1][l+2])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C-1,l+2))),l-2>=0&&(C+1<=7&&(null===(n=u[C+1][l-2])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C+1,l-2)),C-1>=0&&(null===(t=u[C-1][l-2])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C-1,l-2))),C+2<=7&&(l+1<=7&&(null===(s=u[C+2][l+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C+2,l+1)),l-1>=0&&(null===(a=u[C+2][l-1])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C+2,l-1))),C-2>=0&&(l+1<=7&&(null===(v=u[C-2][l+1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C-2,l+1)),l-1>=0&&(null===(d=u[C-2][l-1])||void 0===d?void 0:d.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(C-2,l-1)))}function P(o){var e,i,n,t,s,a,v,d,l=o.CurrentPosition.X,C=o.CurrentPosition.Y;l+1<=7&&(null===(e=u[l+1][C])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C)),l+1<=7&&C+1<=7&&(null===(i=u[l+1][C+1])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C+1)),l+1<=7&&C-1>=0&&(null===(n=u[l+1][C-1])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C-1)),l-1>=0&&(null===(t=u[l-1][C])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C)),l-1>=0&&C+1<=7&&(null===(s=u[l-1][C+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C+1)),l-1>=0&&C-1>=0&&(null===(a=u[l-1][C-1])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C-1)),C+1<=7&&(null===(v=u[l][C+1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l,C+1)),C-1>=0&&(null===(d=u[l][C-1])||void 0===d?void 0:d.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l,C-1))}function c(o,e){var i=new t.Piece(o,e,"Pawn");i.Moves.push(d),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function g(o,e){var i=new t.Piece(o,e,"Rook");i.Moves.push(l),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function f(o,e){var i=new t.Piece(o,e,"Bishop");i.Moves.push(C),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function I(o,e){var i=new t.Piece(o,e,"Knight");i.Moves.push(h),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function p(o,i){var r=new t.Piece(o,i,"King");r.Moves.push(P),u[r.CurrentPosition.X][r.CurrentPosition.Y]=r,o?e=r:n=r}function w(o,e){var i=new t.Piece(o,e,"Queen");i.Moves.push(C),i.Moves.push(l),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function X(){for(var o=0;o<8;o++)for(var e=0;e<8;e++){var i=u[e][o];if(void 0!==i){var n=document.getElementById("row-"+(o+1));if(null==n)throw Error;0===n.children[e].children.length&&L(i)}}}function Y(o){var e=document.getElementById("row-"+(o.Y+1));if(null!=e)return e.children[o.X];throw Error}function M(o){var e=Y(o);null!=e.firstElementChild&&e.removeChild(e.firstElementChild)}function W(o,e){u[o.CurrentPosition.X][o.CurrentPosition.Y]=void 0,o.CurrentPosition=e,u[o.CurrentPosition.X][o.CurrentPosition.Y]=o,o.HasBeenMoved=!0}function L(o){var e,i=Y(o.CurrentPosition),n=(e=o.CurrentPosition,u[e.X][e.Y]);if(null==n)throw Error;for(;null!=i.firstElementChild;)i.removeChild(i.firstElementChild);var t=document.createElement("div");t.setAttribute("style",'background-image: url("./pieces/'+(n.IsWhite?"light":"dark")+"-"+n.Name.toLowerCase()+'.svg")'),t.setAttribute("class"," piece-background"),t.setAttribute("draggable","true"),i.appendChild(t)}function m(o){o.LegalMoves=[];for(var e=0;e<o.Moves.length;e++)o.Moves[e](o)}function E(o){for(var e=0;e<o.LegalMoves.length;e++){var i=Y(o.LegalMoves[e]);i.className=i.className.replace(" legalMove","")}}function N(){a=!1,v=!1;for(var o=function(o){for(var i=function(i){if(void 0===u[i][o])return"continue";m(u[i][o]);var t=u[i][o].IsWhite?n:e;u[i][o].LegalMoves.forEach((function(e){var n;e.X===t.CurrentPosition.X&&e.Y===t.CurrentPosition.Y&&((null===(n=u[i][o])||void 0===n?void 0:n.IsWhite)?v=!0:a=!0)}))},t=0;t<=7;t++)i(t)},i=0;i<=7;i++)o(i)}function b(o){void 0!==u[o.X][o.Y]&&(M(o),u[o.X][o.Y]=void 0)}!function(){var o=document.getElementById("chessBoard");if(null==o)throw Error;for(var e=!0,i=0;i<o.children.length;i++){for(var n=o.children[i],t=0;t<n.children.length;t++)n.children[t].className+=e?" light-cell":" dark-cell",e=!e;e=!e}}(),function(){for(var o=0;o<8;o++)c(!0,new r.Coordinate(o,1));for(g(!0,new r.Coordinate(0,0)),g(!0,new r.Coordinate(7,0)),I(!0,new r.Coordinate(1,0)),I(!0,new r.Coordinate(6,0)),f(!0,new r.Coordinate(2,0)),f(!0,new r.Coordinate(5,0)),p(!0,new r.Coordinate(4,0)),w(!0,new r.Coordinate(3,0)),o=0;o<8;o++)c(!1,new r.Coordinate(o,6));g(!1,new r.Coordinate(0,7)),g(!1,new r.Coordinate(7,7)),I(!1,new r.Coordinate(1,7)),I(!1,new r.Coordinate(6,7)),f(!1,new r.Coordinate(2,7)),f(!1,new r.Coordinate(5,7)),p(!1,new r.Coordinate(4,7)),w(!1,new r.Coordinate(3,7))}(),X(),document.addEventListener("dragstart",(function(e){var i=parseInt(e.path[1].id.replace("col-",""))-1,n=parseInt(e.path[1].getAttribute("row"))-1,t=u[i][n];null!=t&&t.IsWhite===s&&(m(t),function(o){for(var e=0;e<o.LegalMoves.length;e++)Y(o.LegalMoves[e]).className+=" legalMove"}(t),o=t)})),document.addEventListener("dragend",(function(e){var i=parseInt(e.path[1].id.replace("col-",""))-1,n=parseInt(e.path[1].getAttribute("row"))-1;null!=u[i][n]&&E(o)})),document.addEventListener("dragover",(function(o){o.preventDefault()})),document.addEventListener("drop",(function(e){if(e.preventDefault(),!e)return!1;if(e.target.className.includes("legalMove")||e.target.parentElement.className.includes("legalMove")){var i=function(o){var e;if("DIV"===o.nodeName)e=o;else{if("IMG"!==o.nodeName)throw Error;e=o.parentElement}var i=parseInt(e.getAttribute("row"))-1,n=parseInt(e.id.replace("col-",""))-1;return new r.Coordinate(n,i)}(e.target.className.includes("legalMove")?e.target:e.target.parentElement);!1===function(o,e){var i=o.CurrentPosition,n=u[e.X][e.Y];E(o),W(o,e),N();var t=!1;return o.IsWhite&&a&&(t=!0),!1===o.IsWhite&&v&&(t=!0),W(o,i),m(o),void 0!==n&&W(n,n.CurrentPosition),console.log("moveIsIllegal : "+t),X(),t}(o,i)&&(console.log("moved piece!!"),t=i,M(d=(n=o).CurrentPosition),b(t),W(n,t),L(n),u[d.X][d.Y]=void 0,s=!s,N()),E(o)}var n,t,d})),N()})()})();