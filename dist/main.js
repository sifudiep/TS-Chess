(()=>{"use strict";var o={506:(o,i)=>{i.__esModule=!0,i.Coordinate=void 0;i.Coordinate=function(o,i){this.X=o,this.Y=i}},142:(o,i)=>{i.__esModule=!0,i.Piece=void 0;i.Piece=function(o,i,e){this.HasBeenMoved=!1,this.JustMadeFirstMove=!1,this.LegalMoves=[],this.Moves=[],this.IsWhite=o,this.CurrentPosition=i,this.Name=e}}},i={};function e(n){var t=i[n];if(void 0!==t)return t.exports;var r=i[n]={exports:{}};return o[n](r,r.exports,e),r.exports}(()=>{var o,i,n,t=e(142),r=e(506),s=new Audio("./sfx/move.wav"),u=new Audio("./sfx/check.wav"),v=new Audio("./sfx/error.wav"),a=!0,d=[[],[],[],[],[],[],[],[]],C=!1,l=!1;function P(o){var i,e,n,t,s,u,v,a,C,l,P,h,Y,X,w,c;if(0==o.CurrentPosition.Y||7==o.CurrentPosition.Y){var M=o.CurrentPosition,f=o.IsWhite;J(o.CurrentPosition),p(f,M),N(d[M.X][M.Y])}o.IsWhite?(o.CurrentPosition.X-1>=0&&void 0!==d[o.CurrentPosition.X-1][o.CurrentPosition.Y+1]&&!1===(null===(i=d[o.CurrentPosition.X-1][o.CurrentPosition.Y+1])||void 0===i?void 0:i.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y+1)),o.CurrentPosition.X+1<=7&&void 0!==d[o.CurrentPosition.X+1][o.CurrentPosition.Y+1]&&!1===(null===(e=d[o.CurrentPosition.X+1][o.CurrentPosition.Y+1])||void 0===e?void 0:e.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y+1)),void 0===d[o.CurrentPosition.X][o.CurrentPosition.Y+1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+1)),void 0===d[o.CurrentPosition.X][o.CurrentPosition.Y+2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+2))),o.CurrentPosition.X+1<=7&&void 0!==d[o.CurrentPosition.X+1][o.CurrentPosition.Y]&&"Pawn"===(null===(n=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===n?void 0:n.Name)&&(null===(t=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===t?void 0:t.JustMadeFirstMove)&&(null===(s=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y+1)),o.CurrentPosition.X-1>=0&&void 0!==d[o.CurrentPosition.X-1][o.CurrentPosition.Y]&&"Pawn"===(null===(u=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===u?void 0:u.Name)&&(null===(v=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===v?void 0:v.JustMadeFirstMove)&&(null===(a=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y+1))):(o.CurrentPosition.X-1>=0&&void 0!==d[o.CurrentPosition.X-1][o.CurrentPosition.Y-1]&&!0===(null===(C=d[o.CurrentPosition.X-1][o.CurrentPosition.Y-1])||void 0===C?void 0:C.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y-1)),o.CurrentPosition.X+1<=7&&void 0!==d[o.CurrentPosition.X+1][o.CurrentPosition.Y-1]&&!0===(null===(l=d[o.CurrentPosition.X+1][o.CurrentPosition.Y-1])||void 0===l?void 0:l.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y-1)),void 0===d[o.CurrentPosition.X][o.CurrentPosition.Y-1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-1)),void 0===d[o.CurrentPosition.X][o.CurrentPosition.Y-2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-2))),o.CurrentPosition.X+1<=7&&void 0!==d[o.CurrentPosition.X+1][o.CurrentPosition.Y]&&"Pawn"===(null===(P=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===P?void 0:P.Name)&&(null===(h=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===h?void 0:h.JustMadeFirstMove)&&(null===(Y=d[o.CurrentPosition.X+1][o.CurrentPosition.Y])||void 0===Y?void 0:Y.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y-1)),o.CurrentPosition.X-1>=0&&void 0!==d[o.CurrentPosition.X-1][o.CurrentPosition.Y]&&"Pawn"===(null===(X=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===X?void 0:X.Name)&&(null===(w=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===w?void 0:w.JustMadeFirstMove)&&(null===(c=d[o.CurrentPosition.X-1][o.CurrentPosition.Y])||void 0===c?void 0:c.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y-1)))}function h(o){for(var i,e,n,t,s=o.CurrentPosition.X-1;s>=0&&(null===(i=d[s][o.CurrentPosition.Y])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===d[s][o.CurrentPosition.Y]);s--);for(s=o.CurrentPosition.X+1;s<=7&&(null===(e=d[s][o.CurrentPosition.Y])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===d[s][o.CurrentPosition.Y]);s++);for(s=o.CurrentPosition.Y-1;s>=0&&(null===(n=d[o.CurrentPosition.X][s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===d[o.CurrentPosition.X][s]);s--);for(s=o.CurrentPosition.Y+1;s<=7&&(null===(t=d[o.CurrentPosition.X][s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===d[o.CurrentPosition.X][s]);s++);}function Y(o){for(var i,e,n,t,s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y+s<=7&&(null===(i=d[o.CurrentPosition.X+s][o.CurrentPosition.Y+s])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y+s)),void 0===d[o.CurrentPosition.X+s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y+s<=7&&(null===(e=d[o.CurrentPosition.X-s][o.CurrentPosition.Y+s])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y+s)),void 0===d[o.CurrentPosition.X-s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y-s>=0&&(null===(n=d[o.CurrentPosition.X+s][o.CurrentPosition.Y-s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y-s)),void 0===d[o.CurrentPosition.X+s][o.CurrentPosition.Y-s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y-s>=0&&(null===(t=d[o.CurrentPosition.X-s][o.CurrentPosition.Y-s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y-s)),void 0===d[o.CurrentPosition.X-s][o.CurrentPosition.Y-s]);s++);}function X(o){var i,e,n,t,s,u,v,a,C=o.CurrentPosition.Y,l=o.CurrentPosition.X;C+2<=7&&(l+1<=7&&(null===(i=d[l+1][C+2])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C+2)),l-1>=0&&(null===(e=d[l-1][C+2])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C+2))),C-2>=0&&(l+1<=7&&(null===(n=d[l+1][C-2])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C-2)),l-1>=0&&(null===(t=d[l-1][C-2])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C-2))),l+2<=7&&(C+1<=7&&(null===(s=d[l+2][C+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+2,C+1)),C-1>=0&&(null===(u=d[l+2][C-1])||void 0===u?void 0:u.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+2,C-1))),l-2>=0&&(C+1<=7&&(null===(v=d[l-2][C+1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-2,C+1)),C-1>=0&&(null===(a=d[l-2][C-1])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-2,C-1)))}function w(o){var i,e,n,t,s,u,v,a,P,h,Y=o.CurrentPosition.X,X=o.CurrentPosition.Y;Y+1<=7&&(null===(i=d[Y+1][X])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y+1,X)),Y+1<=7&&X+1<=7&&(null===(e=d[Y+1][X+1])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y+1,X+1)),Y+1<=7&&X-1>=0&&(null===(n=d[Y+1][X-1])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y+1,X-1)),Y-1>=0&&(null===(t=d[Y-1][X])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y-1,X)),Y-1>=0&&X+1<=7&&(null===(s=d[Y-1][X+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y-1,X+1)),Y-1>=0&&X-1>=0&&(null===(u=d[Y-1][X-1])||void 0===u?void 0:u.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y-1,X-1)),X+1<=7&&(null===(v=d[Y][X+1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y,X+1)),X-1>=0&&(null===(a=d[Y][X-1])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(Y,X-1));var w=o.IsWhite?C:l;o.HasBeenMoved||w||(void 0===d[5][o.CurrentPosition.Y]&&void 0===d[6][o.CurrentPosition.Y]&&void 0!==d[7][o.CurrentPosition.Y]&&!1===(null===(P=d[7][o.CurrentPosition.Y])||void 0===P?void 0:P.HasBeenMoved)&&(o.LegalMoves.push(new r.Coordinate(6,o.CurrentPosition.Y)),o.LegalMoves.push(new r.Coordinate(7,o.CurrentPosition.Y))),void 0===d[3][o.CurrentPosition.Y]&&void 0===d[2][o.CurrentPosition.Y]&&void 0!==d[0][o.CurrentPosition.Y]&&!1===(null===(h=d[0][o.CurrentPosition.Y])||void 0===h?void 0:h.HasBeenMoved)&&(o.LegalMoves.push(new r.Coordinate(2,o.CurrentPosition.Y)),o.LegalMoves.push(new r.Coordinate(0,o.CurrentPosition.Y))))}function c(o,i){var e=new t.Piece(o,i,"Pawn");e.Moves.push(P),d[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function M(o,i){var e=new t.Piece(o,i,"Rook");e.Moves.push(h),d[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function f(o,i){var e=new t.Piece(o,i,"Bishop");e.Moves.push(Y),d[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function I(o,i){var e=new t.Piece(o,i,"Knight");e.Moves.push(X),d[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function g(o,e){var r=new t.Piece(o,e,"King");r.Moves.push(w),d[r.CurrentPosition.X][r.CurrentPosition.Y]=r,o?i=r:n=r}function p(o,i){var e=new t.Piece(o,i,"Queen");e.Moves.push(Y),e.Moves.push(h),d[e.CurrentPosition.X][e.CurrentPosition.Y]=e}function W(){for(var o=0;o<8;o++)for(var i=0;i<8;i++){var e=d[i][o];if(void 0!==e){var n=document.getElementById("row-"+(o+1));if(null==n)throw Error;0===n.children[i].children.length&&N(e)}}}function L(o){var i=document.getElementById("row-"+(o.Y+1));if(null!=i)return i.children[o.X];throw Error}function m(o){var i=L(o);null!=i.firstElementChild&&i.removeChild(i.firstElementChild)}function E(o,i){d[o.CurrentPosition.X][o.CurrentPosition.Y]=void 0,o.CurrentPosition=i,d[o.CurrentPosition.X][o.CurrentPosition.Y]=o}function N(o){var i,e=L(o.CurrentPosition),n=(i=o.CurrentPosition,d[i.X][i.Y]);if(null==n)throw Error;for(;null!=e.firstElementChild;)e.removeChild(e.firstElementChild);var t=document.createElement("div");t.setAttribute("style",'background-image: url("./pieces/'+(n.IsWhite?"light":"dark")+"-"+n.Name.toLowerCase()+'.svg")'),t.setAttribute("class"," piece-background"),t.setAttribute("draggable","true"),e.appendChild(t)}function B(o,i){var e,n;if("King"===o.Name){var t=o.CurrentPosition.X-i.X;if(Math.abs(t)>1)if(t>0){for(var v=3;v>=2;v--)if(b(o,new r.Coordinate(v,o.CurrentPosition.Y)))return;i.X=2,B(d[0][o.CurrentPosition.Y],new r.Coordinate(3,o.CurrentPosition.Y))}else{for(v=5;v<=6;v++)if(b(o,new r.Coordinate(v,o.CurrentPosition.Y)))return;i.X=6,B(d[7][o.CurrentPosition.Y],new r.Coordinate(5,o.CurrentPosition.Y))}}if("Pawn"===o.Name&&(!1===o.HasBeenMoved&&(o.JustMadeFirstMove=!0),void 0===d[i.X][i.Y])){var P=o.IsWhite?i.Y-1:i.Y+1;void 0!==d[i.X][P]&&"Pawn"===(null===(e=d[i.X][P])||void 0===e?void 0:e.Name)&&(null===(n=d[i.X][P])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&J(new r.Coordinate(i.X,P))}var h=o.CurrentPosition;m(h),J(i),E(o,i),N(o),d[h.X][h.Y]=void 0,a=!a,H(),l||C?u.play():s.play()}function b(o,i){var e=o.CurrentPosition,n=d[i.X][i.Y];F(o),E(o,i),H();var t=!1;return o.IsWhite&&C&&(t=!0),!1===o.IsWhite&&l&&(t=!0),E(o,e),A(o),void 0!==n&&E(n,n.CurrentPosition),t&&v.play(),t}function A(o){o.LegalMoves=[];for(var i=0;i<o.Moves.length;i++)o.Moves[i](o)}function F(o){for(var i=0;i<o.LegalMoves.length;i++){var e=L(o.LegalMoves[i]);e.className=e.className.replace(" legalMove","")}}function H(){C=!1,l=!1;for(var o=function(o){for(var e=function(e){if(void 0===d[e][o])return"continue";A(d[e][o]);var t=d[e][o].IsWhite?n:i;d[e][o].LegalMoves.forEach((function(i){var n;i.X===t.CurrentPosition.X&&i.Y===t.CurrentPosition.Y&&((null===(n=d[e][o])||void 0===n?void 0:n.IsWhite)?l=!0:C=!0)}))},t=0;t<=7;t++)e(t)},e=0;e<=7;e++)o(e)}function J(o){void 0!==d[o.X][o.Y]&&(m(o),d[o.X][o.Y]=void 0)}!function(){var o=document.getElementById("chessBoard");if(null==o)throw Error;for(var i=!0,e=0;e<o.children.length;e++){for(var n=o.children[e],t=0;t<n.children.length;t++)n.children[t].className+=i?" light-cell":" dark-cell",i=!i;i=!i}}(),function(){for(var o=0;o<8;o++)c(!0,new r.Coordinate(o,1));for(M(!0,new r.Coordinate(0,0)),M(!0,new r.Coordinate(7,0)),I(!0,new r.Coordinate(1,0)),I(!0,new r.Coordinate(6,0)),f(!0,new r.Coordinate(2,0)),f(!0,new r.Coordinate(5,0)),g(!0,new r.Coordinate(4,0)),p(!0,new r.Coordinate(3,0)),o=0;o<8;o++)c(!1,new r.Coordinate(o,6));M(!1,new r.Coordinate(0,7)),M(!1,new r.Coordinate(7,7)),I(!1,new r.Coordinate(1,7)),I(!1,new r.Coordinate(6,7)),f(!1,new r.Coordinate(2,7)),f(!1,new r.Coordinate(5,7)),g(!1,new r.Coordinate(4,7)),p(!1,new r.Coordinate(3,7))}(),W(),document.addEventListener("dragstart",(function(i){var e=parseInt(i.path[1].id.replace("col-",""))-1,n=parseInt(i.path[1].getAttribute("row"))-1,t=d[e][n];null!=t&&t.IsWhite===a&&(A(t),function(o){for(var i=0;i<o.LegalMoves.length;i++)L(o.LegalMoves[i]).className+=" legalMove"}(t),o=t)})),document.addEventListener("dragend",(function(i){var e=parseInt(i.path[1].id.replace("col-",""))-1,n=parseInt(i.path[1].getAttribute("row"))-1;null!=d[e][n]&&F(o)})),document.addEventListener("dragover",(function(o){o.preventDefault()})),document.addEventListener("drop",(function(i){if(i.preventDefault(),!i)return!1;if(i.target.className.includes("legalMove")||i.target.parentElement.className.includes("legalMove")){var e=function(o){var i;if("DIV"===o.nodeName)i=o;else{if("IMG"!==o.nodeName)throw Error;i=o.parentElement}var e=parseInt(i.getAttribute("row"))-1,n=parseInt(i.id.replace("col-",""))-1;return new r.Coordinate(n,e)}(i.target.className.includes("legalMove")?i.target:i.target.parentElement);!1===b(o,e)&&(function(){for(var o=0;o<=7;o++)for(var i=0;i<=7;i++){var e=d[i][o];void 0!==e&&"Pawn"===e.Name&&e.JustMadeFirstMove&&(e.JustMadeFirstMove=!1)}}(),B(o,e),o.HasBeenMoved=!0,W()),F(o)}})),H()})()})();