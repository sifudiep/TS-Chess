(()=>{"use strict";var o={506:(o,e)=>{e.__esModule=!0,e.Coordinate=void 0;e.Coordinate=function(o,e){this.X=o,this.Y=e}},142:(o,e)=>{e.__esModule=!0,e.Piece=void 0;e.Piece=function(o,e,i){this.HasBeenMoved=!1,this.LegalMoves=[],this.Moves=[],this.IsWhite=o,this.CurrentPosition=e,this.Name=i}}},e={};function i(n){var t=e[n];if(void 0!==t)return t.exports;var r=e[n]={exports:{}};return o[n](r,r.exports,i),r.exports}(()=>{var o,e,n,t=i(142),r=i(506),s=!0,u=[[],[],[],[],[],[],[],[]],a=!1,d=!1;function v(o){var e,i,n,t;if(0==o.CurrentPosition.Y||7==o.CurrentPosition.Y){var s=o.CurrentPosition,a=o.IsWhite;H(o.CurrentPosition),I(a,s),L(u[s.X][s.Y])}o.IsWhite?(o.CurrentPosition.X-1>=0&&void 0!==u[o.CurrentPosition.X-1][o.CurrentPosition.Y+1]&&!1===(null===(e=u[o.CurrentPosition.X-1][o.CurrentPosition.Y+1])||void 0===e?void 0:e.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y+1)),o.CurrentPosition.X+1<=7&&void 0!==u[o.CurrentPosition.X+1][o.CurrentPosition.Y+1]&&!1===(null===(i=u[o.CurrentPosition.X+1][o.CurrentPosition.Y+1])||void 0===i?void 0:i.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y+1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y+1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y+2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y+2)))):(o.CurrentPosition.X-1>=0&&void 0!==u[o.CurrentPosition.X-1][o.CurrentPosition.Y-1]&&!0===(null===(n=u[o.CurrentPosition.X-1][o.CurrentPosition.Y-1])||void 0===n?void 0:n.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-1,o.CurrentPosition.Y-1)),o.CurrentPosition.X+1<=7&&void 0!==u[o.CurrentPosition.X+1][o.CurrentPosition.Y-1]&&!0===(null===(t=u[o.CurrentPosition.X+1][o.CurrentPosition.Y-1])||void 0===t?void 0:t.IsWhite)&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+1,o.CurrentPosition.Y-1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y-1]&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-1)),void 0===u[o.CurrentPosition.X][o.CurrentPosition.Y-2]&&!1===o.HasBeenMoved&&o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,o.CurrentPosition.Y-2))))}function C(o){for(var e,i,n,t,s=o.CurrentPosition.X-1;s>=0&&(null===(e=u[s][o.CurrentPosition.Y])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===u[s][o.CurrentPosition.Y]);s--);for(s=o.CurrentPosition.X+1;s<=7&&(null===(i=u[s][o.CurrentPosition.Y])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(s,o.CurrentPosition.Y)),void 0===u[s][o.CurrentPosition.Y]);s++);for(s=o.CurrentPosition.Y-1;s>=0&&(null===(n=u[o.CurrentPosition.X][s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===u[o.CurrentPosition.X][s]);s--);for(s=o.CurrentPosition.Y+1;s<=7&&(null===(t=u[o.CurrentPosition.X][s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X,s)),void 0===u[o.CurrentPosition.X][s]);s++);}function l(o){for(var e,i,n,t,s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y+s<=7&&(null===(e=u[o.CurrentPosition.X+s][o.CurrentPosition.Y+s])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y+s)),void 0===u[o.CurrentPosition.X+s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y+s<=7&&(null===(i=u[o.CurrentPosition.X-s][o.CurrentPosition.Y+s])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y+s)),void 0===u[o.CurrentPosition.X-s][o.CurrentPosition.Y+s]);s++);for(s=1;o.CurrentPosition.X+s<=7&&o.CurrentPosition.Y-s>=0&&(null===(n=u[o.CurrentPosition.X+s][o.CurrentPosition.Y-s])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X+s,o.CurrentPosition.Y-s)),void 0===u[o.CurrentPosition.X+s][o.CurrentPosition.Y-s]);s++);for(s=1;o.CurrentPosition.X-s>=0&&o.CurrentPosition.Y-s>=0&&(null===(t=u[o.CurrentPosition.X-s][o.CurrentPosition.Y-s])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&(o.LegalMoves.push(new r.Coordinate(o.CurrentPosition.X-s,o.CurrentPosition.Y-s)),void 0===u[o.CurrentPosition.X-s][o.CurrentPosition.Y-s]);s++);}function P(o){var e,i,n,t,s,a,d,v,C=o.CurrentPosition.Y,l=o.CurrentPosition.X;C+2<=7&&(l+1<=7&&(null===(e=u[l+1][C+2])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C+2)),l-1>=0&&(null===(i=u[l-1][C+2])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C+2))),C-2>=0&&(l+1<=7&&(null===(n=u[l+1][C-2])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+1,C-2)),l-1>=0&&(null===(t=u[l-1][C-2])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-1,C-2))),l+2<=7&&(C+1<=7&&(null===(s=u[l+2][C+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+2,C+1)),C-1>=0&&(null===(a=u[l+2][C-1])||void 0===a?void 0:a.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l+2,C-1))),l-2>=0&&(C+1<=7&&(null===(d=u[l-2][C+1])||void 0===d?void 0:d.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-2,C+1)),C-1>=0&&(null===(v=u[l-2][C-1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(l-2,C-1)))}function h(o){var e,i,n,t,s,v,C,l,P,h,c=o.CurrentPosition.X,Y=o.CurrentPosition.Y;c+1<=7&&(null===(e=u[c+1][Y])||void 0===e?void 0:e.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c+1,Y)),c+1<=7&&Y+1<=7&&(null===(i=u[c+1][Y+1])||void 0===i?void 0:i.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c+1,Y+1)),c+1<=7&&Y-1>=0&&(null===(n=u[c+1][Y-1])||void 0===n?void 0:n.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c+1,Y-1)),c-1>=0&&(null===(t=u[c-1][Y])||void 0===t?void 0:t.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c-1,Y)),c-1>=0&&Y+1<=7&&(null===(s=u[c-1][Y+1])||void 0===s?void 0:s.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c-1,Y+1)),c-1>=0&&Y-1>=0&&(null===(v=u[c-1][Y-1])||void 0===v?void 0:v.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c-1,Y-1)),Y+1<=7&&(null===(C=u[c][Y+1])||void 0===C?void 0:C.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c,Y+1)),Y-1>=0&&(null===(l=u[c][Y-1])||void 0===l?void 0:l.IsWhite)!==o.IsWhite&&o.LegalMoves.push(new r.Coordinate(c,Y-1));var f=o.IsWhite?a:d;o.HasBeenMoved||f||(void 0===u[5][o.CurrentPosition.Y]&&void 0===u[6][o.CurrentPosition.Y]&&void 0!==u[7][o.CurrentPosition.Y]&&!1===(null===(P=u[7][o.CurrentPosition.Y])||void 0===P?void 0:P.HasBeenMoved)&&(o.LegalMoves.push(new r.Coordinate(6,o.CurrentPosition.Y)),o.LegalMoves.push(new r.Coordinate(7,o.CurrentPosition.Y))),void 0===u[3][o.CurrentPosition.Y]&&void 0===u[2][o.CurrentPosition.Y]&&void 0!==u[0][o.CurrentPosition.Y]&&!1===(null===(h=u[0][o.CurrentPosition.Y])||void 0===h?void 0:h.HasBeenMoved)&&(o.LegalMoves.push(new r.Coordinate(2,o.CurrentPosition.Y)),o.LegalMoves.push(new r.Coordinate(0,o.CurrentPosition.Y))))}function c(o,e){var i=new t.Piece(o,e,"Pawn");i.Moves.push(v),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function Y(o,e){var i=new t.Piece(o,e,"Rook");i.Moves.push(C),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function f(o,e){var i=new t.Piece(o,e,"Bishop");i.Moves.push(l),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function g(o,e){var i=new t.Piece(o,e,"Knight");i.Moves.push(P),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function w(o,i){var r=new t.Piece(o,i,"King");r.Moves.push(h),u[r.CurrentPosition.X][r.CurrentPosition.Y]=r,o?e=r:n=r}function I(o,e){var i=new t.Piece(o,e,"Queen");i.Moves.push(l),i.Moves.push(C),u[i.CurrentPosition.X][i.CurrentPosition.Y]=i}function p(){for(var o=0;o<8;o++)for(var e=0;e<8;e++){var i=u[e][o];if(void 0!==i){var n=document.getElementById("row-"+(o+1));if(null==n)throw Error;0===n.children[e].children.length&&L(i)}}}function X(o){var e=document.getElementById("row-"+(o.Y+1));if(null!=e)return e.children[o.X];throw Error}function M(o){var e=X(o);null!=e.firstElementChild&&e.removeChild(e.firstElementChild)}function W(o,e){u[o.CurrentPosition.X][o.CurrentPosition.Y]=void 0,o.CurrentPosition=e,u[o.CurrentPosition.X][o.CurrentPosition.Y]=o}function L(o){var e,i=X(o.CurrentPosition),n=(e=o.CurrentPosition,u[e.X][e.Y]);if(null==n)throw Error;for(;null!=i.firstElementChild;)i.removeChild(i.firstElementChild);var t=document.createElement("div");t.setAttribute("style",'background-image: url("./pieces/'+(n.IsWhite?"light":"dark")+"-"+n.Name.toLowerCase()+'.svg")'),t.setAttribute("class"," piece-background"),t.setAttribute("draggable","true"),i.appendChild(t)}function m(o,e){if("King"===o.Name){var i=o.CurrentPosition.X-e.X;if(Math.abs(i)>1)if(i>0){for(var n=3;n>=2;n--)if(E(o,new r.Coordinate(n,o.CurrentPosition.Y)))return;e.X=2,m(u[0][o.CurrentPosition.Y],new r.Coordinate(3,o.CurrentPosition.Y))}else{for(n=5;n<=6;n++)if(E(o,new r.Coordinate(n,o.CurrentPosition.Y)))return;e.X=6,m(u[7][o.CurrentPosition.Y],new r.Coordinate(5,o.CurrentPosition.Y))}}var t=o.CurrentPosition;M(t),H(e),W(o,e),L(o),u[t.X][t.Y]=void 0,s=!s,b()}function E(o,e){var i=o.CurrentPosition,n=u[e.X][e.Y];N(o),W(o,e),b();var t=!1;return o.IsWhite&&a&&(t=!0),!1===o.IsWhite&&d&&(t=!0),W(o,i),B(o),void 0!==n&&W(n,n.CurrentPosition),console.log("moveIsIllegal : "+t),p(),t}function B(o){o.LegalMoves=[];for(var e=0;e<o.Moves.length;e++)o.Moves[e](o)}function N(o){for(var e=0;e<o.LegalMoves.length;e++){var i=X(o.LegalMoves[e]);i.className=i.className.replace(" legalMove","")}}function b(){a=!1,d=!1;for(var o=function(o){for(var i=function(i){if(void 0===u[i][o])return"continue";B(u[i][o]);var t=u[i][o].IsWhite?n:e;u[i][o].LegalMoves.forEach((function(e){var n;e.X===t.CurrentPosition.X&&e.Y===t.CurrentPosition.Y&&((null===(n=u[i][o])||void 0===n?void 0:n.IsWhite)?d=!0:a=!0)}))},t=0;t<=7;t++)i(t)},i=0;i<=7;i++)o(i)}function H(o){void 0!==u[o.X][o.Y]&&(M(o),u[o.X][o.Y]=void 0)}!function(){var o=document.getElementById("chessBoard");if(null==o)throw Error;for(var e=!0,i=0;i<o.children.length;i++){for(var n=o.children[i],t=0;t<n.children.length;t++)n.children[t].className+=e?" light-cell":" dark-cell",e=!e;e=!e}}(),function(){for(var o=0;o<8;o++)c(!0,new r.Coordinate(o,1));for(Y(!0,new r.Coordinate(0,0)),Y(!0,new r.Coordinate(7,0)),g(!0,new r.Coordinate(1,0)),g(!0,new r.Coordinate(6,0)),f(!0,new r.Coordinate(2,0)),f(!0,new r.Coordinate(5,0)),w(!0,new r.Coordinate(4,0)),I(!0,new r.Coordinate(3,0)),o=0;o<8;o++)c(!1,new r.Coordinate(o,6));Y(!1,new r.Coordinate(0,7)),Y(!1,new r.Coordinate(7,7)),g(!1,new r.Coordinate(1,7)),g(!1,new r.Coordinate(6,7)),f(!1,new r.Coordinate(2,7)),f(!1,new r.Coordinate(5,7)),w(!1,new r.Coordinate(4,7)),I(!1,new r.Coordinate(3,7))}(),p(),document.addEventListener("dragstart",(function(e){var i=parseInt(e.path[1].id.replace("col-",""))-1,n=parseInt(e.path[1].getAttribute("row"))-1,t=u[i][n];null!=t&&(t.IsWhite,B(t),function(o){for(var e=0;e<o.LegalMoves.length;e++)X(o.LegalMoves[e]).className+=" legalMove"}(t),o=t)})),document.addEventListener("dragend",(function(e){var i=parseInt(e.path[1].id.replace("col-",""))-1,n=parseInt(e.path[1].getAttribute("row"))-1;null!=u[i][n]&&N(o)})),document.addEventListener("dragover",(function(o){o.preventDefault()})),document.addEventListener("drop",(function(e){if(e.preventDefault(),!e)return!1;if(e.target.className.includes("legalMove")||e.target.parentElement.className.includes("legalMove")){var i=function(o){var e;if("DIV"===o.nodeName)e=o;else{if("IMG"!==o.nodeName)throw Error;e=o.parentElement}var i=parseInt(e.getAttribute("row"))-1,n=parseInt(e.id.replace("col-",""))-1;return new r.Coordinate(n,i)}(e.target.className.includes("legalMove")?e.target:e.target.parentElement);!1===E(o,i)&&(console.log("moved piece!!"),m(o,i),o.HasBeenMoved=!0),N(o)}})),b()})()})();